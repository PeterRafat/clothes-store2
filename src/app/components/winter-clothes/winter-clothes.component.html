<div class="container" dir="rtl">
  <div class="row">
    <div class="col-12">
      <h1 class="text-center page-title">WINTER CLOTHES</h1>

      <!-- Filter Section - buttons grid -->
      <div class="filters">
        <button
          class="filter-chip"
          [class.active]="selectedSubcategory === 'all'"
          (click)="selectedSubcategory='all'; onSubcategoryChange()">
          جميع الأنواع
        </button>

        <button
          *ngFor="let subcategory of subcategories"
          class="filter-chip"
          [class.active]="selectedSubcategory === toString(subcategory.id)"
          (click)="selectedSubcategory=toString(subcategory.id); onSubcategoryChange()">
          {{ subcategory.name }}
        </button>
      </div>

      <!-- Loading -->
      <div *ngIf="loading" class="text-center">
        <div class="spinner-border" role="status">
          <span class="visually-hidden">جاري التحميل...</span>
        </div>
      </div>

      <!-- Products Horizontal Scroll -->
      <div *ngIf="!loading">
        <div *ngIf="filteredProducts.length === 0" class="alert alert-info text-center">
          <p>لا توجد منتجات شتوية متاحة حالياً</p>
        </div>
        
        <div *ngIf="filteredProducts.length > 0" class="products-carousel-wrapper">
          <button 
            type="button"
            class="scroll-arrows scroll-left" 
            (click)="scrollLeft()"
            title="Scroll Left">
            ‹
          </button>
          <button 
            type="button"
            class="scroll-arrows scroll-right" 
            (click)="scrollRight()"
            title="Scroll Right">
            ›
          </button>
          <div class="products-horizontal-scroll" #scrollContainer>
            <div class="products-container">
              <div class="product-item" *ngFor="let product of filteredProducts">
                <div class="product-card">
                  <div class="image-wrap">
                    <img [src]="product.image_url || 'https://via.placeholder.com/401x288?text=No+Image'" width="401" height="288" alt="{{product.name}}" loading="lazy" decoding="async">
                  </div>
                  <div class="product-meta">
                    <div class="left">
                      <div class="small-title">{{ getSubcategoryName(product.subcategory_id) }}</div>
                      <div class="product-name">{{ product.name || 'Product Name' }}</div>
                      <div class="product-status" *ngIf="product.status">{{ product.status }}</div>
                    </div>
                    <div class="right-price">
                      <div *ngIf="product.priceBeforeOffer && product.priceBeforeOffer > product.price" class="price-with-discount">
                        <div class="current-price">{{ product.price || 0 }} جنيه</div>
                        <div class="original-price">{{ product.priceBeforeOffer }} جنيه</div>
                        <div class="discount-text">بدلاً من</div>
                      </div>
                      <div *ngIf="!product.priceBeforeOffer || product.priceBeforeOffer <= product.price" class="price-normal">
                        {{ product.price || 0 }} جنيه
                      </div>
                    </div>
                  </div>
                  <div class="text-center">
                    <a [routerLink]="['/product', product.id]" class="btn btn-outline-primary mt-2">View Details</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
